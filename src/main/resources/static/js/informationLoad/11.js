(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{aPtR:function(t,i,e){"use strict";e.r(i),e.d(i,"PqsModule",(function(){return W}));var s=e("2kYt"),a=e("40Bj"),n=e("nIj0"),o=e("m1yc"),r=e("PCNd"),l=e("sEIs"),c=e("OZ4H"),d=e("EM62"),b=e("YtkY"),u=e("ruxD"),h=e("qFEQ"),m=e("29Wa"),p=e("Cd2c"),f=e("R7+U"),g=e("mFH5");function y(t,i){if(1&t&&(d.Qb(0),d.Dc(1),d.Pb()),2&t){const t=d.ec();d.Bb(1),d.Ec(t.dictionary.translate("mandatoryField"))}}function v(t,i){1&t&&(d.Qb(0),d.Dc(1,"pq duplicado"),d.Pb())}function P(t,i){if(1&t&&(d.Qb(0),d.Dc(1),d.Pb()),2&t){const t=d.ec();d.Bb(1),d.Ec(t.dictionary.translate("maxOf")+"20 "+t.dictionary.translate("characters"))}}function j(t,i){if(1&t&&(d.Qb(0),d.Dc(1),d.Pb()),2&t){const t=d.ec();d.Bb(1),d.Ec(t.dictionary.translate("mandatoryField"))}}function F(t,i){if(1&t&&(d.Qb(0),d.Dc(1),d.Pb()),2&t){const t=d.ec();d.Bb(1),d.Ec(t.dictionary.translate("maxOf")+"250 "+t.dictionary.translate("characters"))}}function S(t,i){if(1&t&&(d.Sb(0,"mat-option",8),d.Dc(1),d.Rb()),2&t){const t=i.$implicit;d.jc("value",t.value),d.Bb(1),d.Fc(" ",t.label," ")}}function w(t,i){1&t&&(d.Sb(0,"mat-error"),d.Sb(1,"small"),d.Dc(2,"PQS duplicado"),d.Rb(),d.Rb())}let B=(()=>{class t{constructor(t,i,e,s){this.fb=t,this.fs=i,this.ps=e,this.changeDetectorRef=s,this.cummins=window.cummins,this.validDates=!0,this.disabledEvent=new d.o,this.jobPositions=[]}ngOnInit(){this.isNew=!this.data,this.ps.bringTheActivesJopPossitions().subscribe(t=>{this.jobPositions=t}),this.setupForm()}disableFields(){this.fs.disableFields(this.mainForm)}enableFields(){this.fs.enableFields(this.mainForm),this.isNew||(this.id.disable(),this.name.disable(),this.jobPosition.disable())}submit(){const t=this.mainForm.value;let i;return i={id:t.id.toUpperCase(),nombre:t.name.toUpperCase(),del:"N",puestos:t.jobPosition.map(i=>({idProgram:t.id.toUpperCase(),idPuesto:i,del:"N"}))},this.isNew||this.data.pqsXpuestos.filter(i=>!t.jobPosition.find(t=>t==i.idPuesto)).forEach(e=>{const s={idProgram:t.id.toUpperCase(),idPuesto:e.idPuesto,del:"Y"};i.puestos.push(s)}),this.ps.save(i)}setupForm(){var t;this.mainForm=this.fb.group({id:[null,[n.s.required,n.s.maxLength(20)],this.duplicatedPqsValidator.bind(this)],name:[null,[n.s.required,n.s.maxLength(250)]],jobPosition:[null,[n.s.required]]}),this.isNew||(this.mainForm.patchValue({id:this.data.id,name:this.data.nombre,jobPosition:null===(t=this.data.pqsXpuestos)||void 0===t?void 0:t.map(t=>"N"==t.del?t.idPuesto:null),del:this.data.delete}),this.id.disable())}get id(){return this.mainForm.get("id")}get name(){return this.mainForm.get("name")}get jobPosition(){return this.mainForm.get("jobPosition")}duplicatedPqsValidator(t){return this.ps.findByCriteria({id:t.value,del:"N"}).pipe(Object(b.a)(t=>{var i;return 0===t.length||1==t.length&&(null===(i=this.data)||void 0===i?void 0:i.id)==t[0].id?null:{duplicated:!0}}),Object(u.a)(()=>this.changeDetectorRef.markForCheck()))}}return t.\u0275fac=function(i){return new(i||t)(d.Mb(n.d),d.Mb(o.g),d.Mb(o.n),d.Mb(d.h))},t.\u0275cmp=d.Gb({type:t,selectors:[["infL-main-form"]],inputs:{data:"data",dictionary:"dictionary"},decls:26,vars:12,consts:[["autocomplete","off",3,"formGroup"],["fxLayout","row","fxLayout.xs","column"],["fxFlex","100%"],["formControlName","id","matInput","",3,"placeholder"],[4,"ngIf"],["formControlName","name","matInput","",3,"placeholder"],["formControlName","jobPosition","multiple",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(t,i){1&t&&(d.Sb(0,"form",0),d.Sb(1,"div",1),d.Sb(2,"div",2),d.Sb(3,"mat-form-field"),d.Nb(4,"input",3),d.Sb(5,"mat-error"),d.Bc(6,y,2,1,"ng-container",4),d.Bc(7,v,2,0,"ng-container",4),d.Bc(8,P,2,1,"ng-container",4),d.Rb(),d.Rb(),d.Rb(),d.Rb(),d.Sb(9,"div",1),d.Sb(10,"div",2),d.Sb(11,"mat-form-field"),d.Nb(12,"input",5),d.Sb(13,"mat-error"),d.Bc(14,j,2,1,"ng-container",4),d.Bc(15,F,2,1,"ng-container",4),d.Rb(),d.Rb(),d.Rb(),d.Rb(),d.Sb(16,"div",1),d.Sb(17,"div",2),d.Sb(18,"mat-form-field"),d.Sb(19,"mat-label"),d.Dc(20),d.Rb(),d.Sb(21,"mat-select",6),d.Bc(22,S,2,2,"mat-option",7),d.Rb(),d.Sb(23,"mat-error"),d.Dc(24),d.Rb(),d.Rb(),d.Rb(),d.Rb(),d.Bc(25,w,3,0,"mat-error",4),d.Rb()),2&t&&(d.jc("formGroup",i.mainForm),d.Bb(4),d.jc("placeholder",i.dictionary.translate("courseId")+" *"),d.Bb(2),d.jc("ngIf",i.id.invalid&&i.id.errors.required),d.Bb(1),d.jc("ngIf",i.id.invalid&&i.id.errors.duplicated),d.Bb(1),d.jc("ngIf",i.id.invalid&&i.id.errors.maxlength),d.Bb(4),d.jc("placeholder",i.dictionary.translate("courseName")+" *"),d.Bb(2),d.jc("ngIf",i.name.invalid&&i.name.errors.required),d.Bb(1),d.jc("ngIf",i.name.invalid&&i.name.errors.maxlength),d.Bb(5),d.Ec(i.dictionary.translate("jopPositionsApplies")+"*"),d.Bb(2),d.jc("ngForOf",i.jobPositions),d.Bb(2),d.Fc(" ",i.dictionary.translate("mandatoryField")," "),d.Bb(1),d.jc("ngIf",i.mainForm.hasError("duplicated")))},directives:[n.t,n.m,n.f,h.c,h.a,m.c,n.c,p.b,n.l,n.e,m.b,s.l,m.f,f.a,s.k,g.n],styles:[".mat-form-field[_ngcontent-%COMP%]{min-inline-size:95%}"]}),t})(),R=(()=>{class t{constructor(t,i,e){this.data=t,this.dialogRef=i,this.message=e,this.loading=!1}ngOnInit(){this.title=this.data.dictionary.translate(this.data.pqs?"editPqs":"addPqs")}onClose(){this.dialogRef.close()}onSubmit(){this.loading=!0,this.mfc.disableFields(),this.mfc.submit().subscribe(()=>{this.loading=!1,this.mfc.enableFields(),this.dialogRef.close({})},t=>{this.loading=!1,this.mfc.enableFields(),this.message.genericHttpError()})}}return t.\u0275fac=function(i){return new(i||t)(d.Mb(c.a),d.Mb(c.f),d.Mb(o.k))},t.\u0275cmp=d.Gb({type:t,selectors:[["infL-main-form-dialog"]],viewQuery:function(t,i){var e;1&t&&d.Hc(B,!0),2&t&&d.pc(e=d.bc())&&(i.mfc=e.first)},decls:2,vars:7,consts:[[3,"disabled","loading","title","submitText","cancelText","closeEvent","submitEvent"],[2,"width","200px",3,"data","dictionary"]],template:function(t,i){1&t&&(d.Sb(0,"shared-form-dialog",0),d.ac("closeEvent",(function(){return i.onClose()}))("submitEvent",(function(){return i.onSubmit()})),d.Nb(1,"infL-main-form",1),d.Rb()),2&t&&(d.jc("disabled",i.loading||(null==i.mfc?null:i.mfc.mainForm.pristine)||!(null!=i.mfc&&i.mfc.mainForm.valid))("loading",i.loading)("title",i.title)("submitText",i.data.dictionary.translate("save"))("cancelText",i.data.dictionary.translate("cancel")),d.Bb(1),d.jc("data",i.data.pqs)("dictionary",i.data.dictionary))},directives:[o.f,B],styles:[""]}),t})();var x=e("J0Eg");let E=(()=>{class t extends x.a{constructor(t){super(),this.ps=t}loadData(t){let i;return i={id:null==t?void 0:t.id,nombre:null==t?void 0:t.name,del:"N"},this.dataSource.clearAll(),this.ps.findByCriteria(i).pipe(Object(b.a)(t=>{console.log("Resp",t),t.map(t=>({id:t.id,nombre:t.nombre,jobPositions:t.puestos.filter(t=>"N"==t.del).map(t=>t.puesto.puesto).join(","),pqsXpuestos:t.puestos}))}))}loadNewData(){let t;return t={del:"N"},this.ps.getPQS(t)}push(t){this.dataSource.push(t)}generateJobs(t){return console.log("Array",t),t.filter(t=>"N"==t.del).map(t=>t.puesto.puesto).join(",")}}return t.\u0275fac=function(i){return new(i||t)(d.Wb(o.n))},t.\u0275prov=d.Ib({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function I(t,i){1&t&&d.Nb(0,"shared-progress-bar")}let D=(()=>{class t{constructor(t,i,e,s){this.mts=t,this.message=i,this.dialog=e,this.ps=s,this.columns=N,this.loading=!1,this.operations=C,this.subscriptions=[],this.eventListeners(),this.getDataTable()}ngOnInit(){for(let t=0;t<this.columns.length;t++)if(this.columns[t].label=this.dictionary.translate(N[t].label),"operations"==this.columns[t].key)for(let i=0;i<this.columns[t].value.length;i++)this.columns[t].value[i].label=this.dictionary.translate(N[t].value[i].label)}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}onOperation(t){switch(t.operation){case"edit":this.onEdit(t.item);break;case"delete":this.onDelete(t.item)}}getDataTable(){this.ps.getPQS({del:"N"}).subscribe(t=>{console.log("Data",t),this.dataSource=t})}onAdd(){this.dialog.open(R,{disableClose:!0,height:"550px",width:"600px",data:{dictionary:this.dictionary,pqs:null}}).afterClosed().subscribe(t=>{t&&(this.getDataTable(),this.message.genericSaveMessage())})}onEdit(t){this.dialog.open(R,{disableClose:!0,height:"550px",width:"600px",data:{dictionary:this.dictionary,pqs:t}}).afterClosed().subscribe(t=>{t&&(this.message.genericSaveMessage(),this.getDataTable())})}onDelete(t){this.loading=!0,this.ps.delete(t.id).subscribe(t=>{this.message.show("PQS Eliminado"),this.loading=!1,this.getDataTable()},t=>{this.message.genericHttpError(),this.loading=!1})}eventListeners(){this.subscriptions.push(this.mts.dataEvent.subscribe(t=>this.operations.forEach(i=>i.disabled=0===t.length)))}}return t.\u0275fac=function(i){return new(i||t)(d.Mb(E),d.Mb(o.k),d.Mb(c.b),d.Mb(o.n))},t.\u0275cmp=d.Gb({type:t,selectors:[["infL-main-table"]],inputs:{dictionary:"dictionary"},decls:3,vars:6,consts:[[4,"ngIf"],[3,"dictionary","columns","data","showPagination","operationEvent"],[3,"text","callback"]],template:function(t,i){1&t&&(d.Bc(0,I,1,0,"shared-progress-bar",0),d.Sb(1,"shared-search-table",1),d.ac("operationEvent",(function(t){return i.onOperation(t)})),d.Rb(),d.Sb(2,"shared-add-button",2),d.ac("callback",(function(){return i.onAdd()})),d.Rb()),2&t&&(d.jc("ngIf",i.loading),d.Bb(1),d.jc("dictionary",i.dictionary)("columns",i.columns)("data",i.dataSource)("showPagination",!0),d.Bb(1),d.jc("text",i.dictionary.translate("addPqs")))},directives:[s.l,o.v,o.a,o.o],styles:[""]}),t})();const N=[{key:"id",label:"courseId"},{key:"nombre",label:"courseName"},{key:"jobPositions",label:"jopPositionsApplies"},{key:"operations",label:"actions",type:o.b.Operations,value:[{label:"edit",matIcon:"edit",operation:"edit"},{label:"delete",matIcon:"delete",operation:"delete"}]}],C=[{disabled:!1,faIcon:"faFileExcel",label:"Exportar Reporte",operation:"export"}];function q(t,i){if(1&t&&(d.Sb(0,"div"),d.Nb(1,"infL-main-table",1),d.Rb()),2&t){const t=d.ec();d.Bb(1),d.jc("dictionary",t.dictionary)}}let M=(()=>{class t{constructor(t,i,e,s,a){this.dialog=t,this.message=i,this.mts=e,this.ps=s,this.tls=a,this.dictionary=new o.j,this.fields=k,this.loading=!1,this.flag=!1}ngOnInit(){this.tls.getLenguaje().subscribe(t=>{this.dictionary.setLanguage(t.language),this.flag=!0})}onAdd(){this.dialog.open(R,{disableClose:!0,height:"550px",width:"600px",data:{dictionary:this.dictionary,pqs:null}}).afterClosed().subscribe(t=>{t&&(this.mts.push(t),this.mts.loadData(null).subscribe(),this.message.genericSaveMessage())})}onSearch(t){return t?(this.loading=!0,this.mts.loadData(t).subscribe(()=>{},t=>this.message.genericHttpError(t),()=>this.loading=!1)):this.mts.loadData(null).subscribe(),null}}return t.\u0275fac=function(i){return new(i||t)(d.Mb(c.b),d.Mb(o.k),d.Mb(E),d.Mb(o.n),d.Mb(o.u))},t.\u0275cmp=d.Gb({type:t,selectors:[["infL-main-view"]],decls:1,vars:1,consts:[[4,"ngIf"],[3,"dictionary"]],template:function(t,i){1&t&&d.Bc(0,q,2,1,"div",0),2&t&&d.jc("ngIf",i.flag)},directives:[s.l,D],styles:[""]}),t})();const k=[{label:"Id del Curso",type:"text",value:"id"},{label:"Nombre del Curso",type:"text",value:"name"}],O=[{component:M,path:""}];let L=(()=>{class t{}return t.\u0275mod=d.Kb({type:t}),t.\u0275inj=d.Jb({factory:function(i){return new(i||t)},imports:[[l.a.forChild(O)],l.a]}),t})();var Q=e("gcUQ"),T=e("KZIX"),A=e("FlRo"),J=e("cePI"),H=e("iAde"),G=e("k8N0"),U=e("PBFl"),X=e("bFHC"),Y=e("Jb3d"),K=e("66mq"),V=e("csyo");let W=(()=>{class t{}return t.\u0275mod=d.Kb({type:t}),t.\u0275inj=d.Jb({factory:function(i){return new(i||t)},imports:[[s.c,L,a.a,n.g,Q.c,m.e,p.c,g.m,f.b,T.a,A.m,n.q,J.c,H.b,G.a,o.t,r.a,U.c,c.e,X.b,Y.b,K.b,V.b]]}),t})()}}]);