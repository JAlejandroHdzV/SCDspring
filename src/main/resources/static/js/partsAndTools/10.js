(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{rpxx:function(t,e,i){"use strict";i.r(e),i.d(e,"ToolsModule",(function(){return it}));var a=i("2kYt"),n=i("40Bj"),s=i("nIj0"),r=i("m1yc"),o=i("PCNd"),l=i("sEIs"),c=i("OZ4H"),d=i("EM62"),u=i("YtkY"),b=i("ruxD"),h=i("29Wa"),p=i("Cd2c");function m(t,e){if(1&t&&(d.Qb(0),d.Dc(1),d.Pb()),2&t){const t=d.ec();d.Bb(1),d.Fc(" ",t.dictionary.translate("mandatoryField")," ")}}function g(t,e){if(1&t&&(d.Qb(0),d.Dc(1),d.Pb()),2&t){const t=d.ec();d.Bb(1),d.Fc(" ",t.dictionary.translate("maxOf")+"50 "+t.dictionary.translate("characters")," ")}}function f(t,e){if(1&t&&(d.Qb(0),d.Dc(1),d.Pb()),2&t){const t=d.ec();d.Bb(1),d.Fc(" ",t.dictionary.translate("duplicatedValues")," ")}}function y(t,e){if(1&t&&(d.Qb(0),d.Dc(1),d.Pb()),2&t){const t=d.ec();d.Bb(1),d.Ec(t.dictionary.translate("mandatoryField"))}}function v(t,e){if(1&t&&(d.Qb(0),d.Dc(1),d.Pb()),2&t){const t=d.ec();d.Bb(1),d.Ec(t.dictionary.translate("maxOf")+"50 "+t.dictionary.translate("characters"))}}function D(t,e){if(1&t&&(d.Qb(0),d.Dc(1),d.Pb()),2&t){const t=d.ec();d.Bb(1),d.Ec(t.dictionary.translate("mandatoryField"))}}function N(t,e){if(1&t&&(d.Qb(0),d.Dc(1),d.Pb()),2&t){const t=d.ec();d.Bb(1),d.Ec(t.dictionary.translate("maxOf")+"200 "+t.dictionary.translate("characters"))}}function B(t,e){if(1&t&&(d.Qb(0),d.Dc(1),d.Pb()),2&t){const t=d.ec();d.Bb(1),d.Ec(t.dictionary.translate("mandatoryField"))}}function x(t,e){if(1&t&&(d.Qb(0),d.Dc(1),d.Pb()),2&t){const t=d.ec();d.Bb(1),d.Ec(t.dictionary.translate("maxOf")+"200 "+t.dictionary.translate("characters"))}}function P(t,e){if(1&t&&(d.Qb(0),d.Dc(1),d.Pb()),2&t){const t=d.ec();d.Bb(1),d.Ec(t.dictionary.translate("mandatoryField"))}}function F(t,e){if(1&t&&(d.Qb(0),d.Dc(1),d.Pb()),2&t){const t=d.ec();d.Bb(1),d.Ec(t.dictionary.translate("maxOf")+"200 "+t.dictionary.translate("characters"))}}function j(t,e){if(1&t&&(d.Qb(0),d.Dc(1),d.Pb()),2&t){const t=d.ec();d.Bb(1),d.Ec(t.dictionary.translate("mandatoryField"))}}function w(t,e){if(1&t&&(d.Qb(0),d.Dc(1),d.Pb()),2&t){const t=d.ec();d.Bb(1),d.Ec(t.dictionary.translate("maxOf")+"10 "+t.dictionary.translate("characters"))}}let E=(()=>{class t{constructor(t,e,i,a,n){this.fb=t,this.fs=e,this.ts=i,this.fileS=a,this.changeDetectorRef=n,this.ummins=window.cummins,this.disabledEvent=new d.o,this.specification=[]}get partNumber(){return this.mainForm.get("partNumber")}get oldPartNumber(){return this.mainForm.get("oldPartNumber")}get spanishDescription(){return this.mainForm.get("spanishDescription")}get englishDescription(){return this.mainForm.get("englishDescription")}get portugueseDescription(){return this.mainForm.get("portugueseDescription")}get salesCode(){return this.mainForm.get("salesCode")}ngOnInit(){console.log("Data",this.data),this.isNew=!this.data,this.setupForm()}disableFields(){this.fs.disableFields(this.mainForm)}enableFields(){this.fs.enableFields(this.mainForm),this.isNew||(this.partNumber.disable(),this.oldPartNumber.disable(),this.spanishDescription.disable(),this.englishDescription.disable(),this.portugueseDescription.disable(),this.salesCode.disable())}submit(){const t=this.mainForm.value;let e;return e={nP:t.partNumber,nPAnterior:t.oldPartNumber,dSpanish:t.spanishDescription,dEnglish:t.englishDescription,dPortuguese:t.portugueseDescription,codigoVenta:t.salesCode,del:"N",especificacion:null,fileName:null,fileType:null},console.log("File",this.specification[0]),this.specification[0]?this.fileS.saveTools(this.specification[0].data,e):this.isNew?this.ts.save(e):this.ts.update(e,e.nP)}setupForm(){this.mainForm=this.fb.group({partNumber:[null,[s.u.required,s.u.maxLength(50)],this.duplicatedToolValidator.bind(this)],oldPartNumber:[null,[s.u.required,s.u.maxLength(50)]],spanishDescription:[null,[s.u.required,s.u.maxLength(200)]],englishDescription:[null,[s.u.required,s.u.maxLength(200)]],portugueseDescription:[null,[s.u.required,s.u.maxLength(200)]],salesCode:[null,[s.u.required,s.u.maxLength(100)]]}),this.isNew||(this.partNumber.disable(),this.mainForm.patchValue({partNumber:this.data.nP,oldPartNumber:this.data.nPAnterior,spanishDescription:this.data.dSpanish,englishDescription:this.data.dEnglish,portugueseDescription:this.data.dPortuguese,salesCode:this.data.codigoVenta}),this.data.fileName&&(this.specification[0]={name:this.data.fileName,url:this.fileS.getUrlById(this.data.nP),type:this.data.fileType,base64:this.data.especificacion,data:this.base64ToBlob(this.data.especificacion,this.data.fileType,this.data.fileName)},console.log("File64",this.specification[0])))}base64ToBlob(t,e,i,a=512){t=t.replace(/\s/g,"");let n=atob(t),s=[];for(let o=0;o<n.length;o+=a){let t=n.slice(o,o+a),e=new Array(t.length);for(var r=0;r<t.length;r++)e[r]=t.charCodeAt(r);let i=new Uint8Array(e);s.push(i)}return new File(s,i,{type:e})}duplicatedToolValidator(t){return this.ts.findExisting({nP:t.value,del:"N"}).pipe(Object(u.a)(t=>{var e;return 0===t.length||1==t.length&&(null===(e=this.data)||void 0===e?void 0:e.nP)==t[0].nP?null:{duplicated:!0}}),Object(b.a)(()=>this.changeDetectorRef.markForCheck()))}}return t.\u0275fac=function(e){return new(e||t)(d.Mb(s.f),d.Mb(r.g),d.Mb(r.u),d.Mb(r.d),d.Mb(d.h))},t.\u0275cmp=d.Gb({type:t,selectors:[["pat-main-form"]],inputs:{data:"data",dictionary:"dictionary"},decls:33,vars:25,consts:[["autocomplete","off",3,"formGroup"],[2,"width","443px"],["formControlName","partNumber","matInput","",3,"placeholder"],[4,"ngIf"],["formControlName","oldPartNumber","matInput","",3,"placeholder"],["formControlName","spanishDescription","matInput","",3,"placeholder"],["formControlName","englishDescription","matInput","",3,"placeholder"],["formControlName","portugueseDescription","matInput","",3,"placeholder"],["formControlName","salesCode","matInput","",3,"placeholder"],["accept","application/pdf","maxFileSize","10MB",3,"disabled","files","mainForm","option","lengthFile"]],template:function(t,e){1&t&&(d.Sb(0,"form",0),d.Sb(1,"mat-form-field",1),d.Nb(2,"input",2),d.Sb(3,"mat-error"),d.Bc(4,m,2,1,"ng-container",3),d.Bc(5,g,2,1,"ng-container",3),d.Bc(6,f,2,1,"ng-container",3),d.Rb(),d.Rb(),d.Sb(7,"mat-form-field",1),d.Nb(8,"input",4),d.Sb(9,"mat-error"),d.Bc(10,y,2,1,"ng-container",3),d.Bc(11,v,2,1,"ng-container",3),d.Rb(),d.Rb(),d.Sb(12,"mat-form-field",1),d.Nb(13,"input",5),d.Sb(14,"mat-error"),d.Bc(15,D,2,1,"ng-container",3),d.Bc(16,N,2,1,"ng-container",3),d.Rb(),d.Rb(),d.Sb(17,"mat-form-field",1),d.Nb(18,"input",6),d.Sb(19,"mat-error"),d.Bc(20,B,2,1,"ng-container",3),d.Bc(21,x,2,1,"ng-container",3),d.Rb(),d.Rb(),d.Sb(22,"mat-form-field",1),d.Nb(23,"input",7),d.Sb(24,"mat-error"),d.Bc(25,P,2,1,"ng-container",3),d.Bc(26,F,2,1,"ng-container",3),d.Rb(),d.Rb(),d.Sb(27,"mat-form-field",1),d.Nb(28,"input",8),d.Sb(29,"mat-error"),d.Bc(30,j,2,1,"ng-container",3),d.Bc(31,w,2,1,"ng-container",3),d.Rb(),d.Rb(),d.Nb(32,"shared-file-upload-control",9),d.Rb()),2&t&&(d.jc("formGroup",e.mainForm),d.Bb(2),d.jc("placeholder",e.dictionary.translate("partNumber")+" *"),d.Bb(2),d.jc("ngIf",e.partNumber.invalid&&e.partNumber.errors.required),d.Bb(1),d.jc("ngIf",e.partNumber.invalid&&e.partNumber.errors.maxlength),d.Bb(1),d.jc("ngIf",e.partNumber.invalid&&e.partNumber.errors.duplicated),d.Bb(2),d.jc("placeholder",e.dictionary.translate("oldPartNumber")+" *"),d.Bb(2),d.jc("ngIf",e.oldPartNumber.invalid&&e.oldPartNumber.errors.required),d.Bb(1),d.jc("ngIf",e.oldPartNumber.invalid&&e.oldPartNumber.errors.maxlength),d.Bb(2),d.jc("placeholder",e.dictionary.translate("spanishDescription")+" *"),d.Bb(2),d.jc("ngIf",e.spanishDescription.invalid&&e.spanishDescription.errors.required),d.Bb(1),d.jc("ngIf",e.spanishDescription.invalid&&e.spanishDescription.errors.maxlength),d.Bb(2),d.jc("placeholder",e.dictionary.translate("englishDescription")+" *"),d.Bb(2),d.jc("ngIf",e.englishDescription.invalid&&e.englishDescription.errors.required),d.Bb(1),d.jc("ngIf",e.englishDescription.invalid&&e.englishDescription.errors.maxlength),d.Bb(2),d.jc("placeholder",e.dictionary.translate("portugueseDescription")+" *"),d.Bb(2),d.jc("ngIf",e.portugueseDescription.invalid&&e.portugueseDescription.errors.required),d.Bb(1),d.jc("ngIf",e.portugueseDescription.invalid&&e.portugueseDescription.errors.maxlength),d.Bb(2),d.jc("placeholder",e.dictionary.translate("salesCode")+" *"),d.Bb(2),d.jc("ngIf",e.salesCode.invalid&&e.salesCode.errors.required),d.Bb(1),d.jc("ngIf",e.salesCode.invalid&&e.salesCode.errors.maxlength),d.Bb(1),d.jc("disabled",!1)("files",e.specification)("mainForm",e.mainForm)("option",e.dictionary.translate("fileUp"))("lengthFile",e.dictionary.translate("lengthFile")))},directives:[s.v,s.o,s.h,h.c,s.d,p.b,s.n,s.g,h.b,a.l,r.e],styles:[".mat-dialog-content[_ngcontent-%COMP%]{display:block;margin:0 -24px;padding:0 24px;max-height:65vh;overflow:auto;width:450px}"]}),t})(),I=(()=>{class t{constructor(t,e,i){this.data=t,this.dialogRef=e,this.message=i,this.loading=!1}ngOnInit(){this.title=this.data.dictionary.translate(this.data.tool?"editTools":"addTools")}onClose(){this.dialogRef.close()}onSubmit(){this.loading=!0,this.mfc.disableFields(),this.mfc.submit().subscribe(()=>{this.loading=!1,this.mfc.enableFields(),this.dialogRef.close({})},t=>{this.loading=!1,this.mfc.enableFields(),this.message.show(t.message||"Error de conexi\xf3n")})}}return t.\u0275fac=function(e){return new(e||t)(d.Mb(c.a),d.Mb(c.f),d.Mb(r.i))},t.\u0275cmp=d.Gb({type:t,selectors:[["pat-main-form-dialog"]],viewQuery:function(t,e){var i;1&t&&d.Hc(E,!0),2&t&&d.pc(i=d.bc())&&(e.mfc=i.first)},decls:2,vars:7,consts:[[3,"disabled","loading","title","submitText","cancelText","closeEvent","submitEvent"],[2,"width","200px",3,"data","dictionary"]],template:function(t,e){1&t&&(d.Sb(0,"shared-form-dialog",0),d.ac("closeEvent",(function(){return e.onClose()}))("submitEvent",(function(){return e.onSubmit()})),d.Nb(1,"pat-main-form",1),d.Rb()),2&t&&(d.jc("disabled",e.loading||(null==e.mfc?null:e.mfc.mainForm.pristine)||!(null!=e.mfc&&e.mfc.mainForm.valid))("loading",e.loading)("title",e.title)("submitText",e.data.dictionary.translate("save"))("cancelText",e.data.dictionary.translate("cancel")),d.Bb(1),d.jc("data",e.data.tool)("dictionary",e.data.dictionary))},directives:[r.f,E],styles:[""]}),t})();var S=i("8j5Y"),C=i("J+dc"),R=i("J0Eg");let O=(()=>{class t extends R.a{constructor(t){super(),this.ts=t}loadData(t){return this.ts.findByCriteria({nP:null==t?void 0:t.np,nPAnterior:null==t?void 0:t.npanterior,dSpanish:null==t?void 0:t.dspanish,dEnglish:null==t?void 0:t.denglish,dPortuguese:null==t?void 0:t.dportuguese,codigoVenta:null==t?void 0:t.codigoventa,del:"N"}).pipe(Object(S.a)(t=>this.dataSource.replaceAll(t)),Object(C.a)(1))}push(t){this.dataSource.push(t)}}return t.\u0275fac=function(e){return new(e||t)(d.Wb(r.u))},t.\u0275prov=d.Ib({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function M(t,e){1&t&&d.Nb(0,"shared-progress-bar")}let k=(()=>{class t{constructor(t,e,i,a){this.mts=t,this.message=e,this.dialog=i,this.ts=a,this.columns=T,this.loading=!1,this.operations=Q,this.subscriptions=[],this.eventListeners(),this.mts.loadData().subscribe(t=>{this.dataSource=t})}ngOnInit(){for(let t=0;t<this.columns.length;t++)if(this.columns[t].label=this.dictionary.translate(T[t].label),"operations"==this.columns[t].key)for(let e=0;e<this.columns[t].value.length;e++)this.columns[t].value[e].label=this.dictionary.translate(T[t].value[e].label);console.log("Columns",this.columns)}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}onOperation(t){switch(t.operation){case"edit":this.onEdit(t.item);break;case"delete":this.onDelete(t.item)}}onEdit(t){this.dialog.open(I,{disableClose:!0,height:"600px",width:"500px",data:{dictionary:this.dictionary,tool:t}}).afterClosed().pipe(Object(b.a)(()=>this.mts.loadData().subscribe(t=>{this.dataSource=t}))).subscribe(t=>{t&&this.message.genericSaveMessage()},t=>this.message.show(t.message||"Error de conexi\xf3n"))}onDelete(t){this.loading=!0,this.ts.delete(t.nP).subscribe(()=>{this.message.show("Herramienta Eliminada"),this.mts.loadData(null).subscribe(t=>{this.dataSource=t}),this.loading=!1},t=>{this.message.show(t.message||"Error de conexi\xf3n"),this.loading=!1})}eventListeners(){this.subscriptions.push(this.mts.dataEvent.subscribe(t=>this.operations.forEach(e=>e.disabled=0===t.length)))}}return t.\u0275fac=function(e){return new(e||t)(d.Mb(O),d.Mb(r.i),d.Mb(c.b),d.Mb(r.u))},t.\u0275cmp=d.Gb({type:t,selectors:[["pat-main-table"]],inputs:{dictionary:"dictionary"},decls:2,vars:5,consts:[[4,"ngIf"],[3,"dictionary","columns","data","showPagination","operationEvent"]],template:function(t,e){1&t&&(d.Bc(0,M,1,0,"shared-progress-bar",0),d.Sb(1,"shared-search-table",1),d.ac("operationEvent",(function(t){return e.onOperation(t)})),d.Rb()),2&t&&(d.jc("ngIf",e.loading),d.Bb(1),d.jc("dictionary",e.dictionary)("columns",e.columns)("data",e.dataSource)("showPagination",!0))},directives:[a.l,r.x,r.o],styles:[""]}),t})();const T=[{key:"nP",label:"partNumber"},{key:"nPAnterior",label:"oldPartNumber"},{key:"dSpanish",label:"spanishDescription"},{key:"dEnglish",label:"englishDescription"},{key:"dPortuguese",label:"portugueseDescription"},{key:"codigoVenta",label:"salesCode"},{key:"operations",label:"actions",type:r.b.Operations,value:[{label:"edit",matIcon:"edit",operation:"edit"},{label:"delete",matIcon:"delete",operation:"delete"}]}],Q=[{disabled:!1,faIcon:"faFileExcel",label:"Exportar Reporte",operation:"export"}];function q(t,e){if(1&t){const t=d.Tb();d.Sb(0,"div"),d.Nb(1,"pat-main-table",1),d.Sb(2,"shared-add-button",2),d.ac("callback",(function(){return d.sc(t),d.ec().onAdd()})),d.Rb(),d.Rb()}if(2&t){const t=d.ec();d.Bb(1),d.jc("dictionary",t.dictionary),d.Bb(1),d.jc("text",t.dictionary.translate("addTools"))}}let A=(()=>{class t{constructor(t,e,i,a){this.dialog=t,this.message=e,this.mts=i,this.tls=a,this.dictionary=new r.h,this.fields=L,this.loading=!1,this.flag=!1}ngOnInit(){this.tls.getLenguaje().subscribe(t=>{this.dictionary.setLanguage(t.language),this.flag=!0})}onAdd(){this.dialog.open(I,{disableClose:!0,height:"600px",width:"500px",data:{dictionary:this.dictionary,tool:null}}).afterClosed().pipe(Object(b.a)(()=>this.mts.loadData().subscribe())).subscribe(t=>{t&&(this.mts.push(t),this.message.genericSaveMessage())},t=>this.message.show(t.message||"Error de conexi\xf3n"))}onSearch(t){return this.loading=!0,t?this.mts.loadData(t).pipe(Object(b.a)(()=>this.loading=!1)).subscribe(()=>{},t=>this.message.genericHttpError(t.message||"Error de conexi\xf3n")):this.mts.loadData().pipe(Object(b.a)(()=>this.loading=!1)).subscribe(),null}}return t.\u0275fac=function(e){return new(e||t)(d.Mb(c.b),d.Mb(r.i),d.Mb(O),d.Mb(r.v))},t.\u0275cmp=d.Gb({type:t,selectors:[["pat-main-view"]],decls:1,vars:1,consts:[[4,"ngIf"],[3,"dictionary"],[3,"text","callback"]],template:function(t,e){1&t&&d.Bc(0,q,3,2,"div",0),2&t&&d.jc("ngIf",e.flag)},directives:[a.l,k,r.a],styles:[""]}),t})();const L=[{label:"NP",type:"text",value:"np"},{label:"NP Anterior",type:"text",value:"npanterior"},{label:"Espa\xf1ol",type:"text",value:"dspanish"},{label:"Ingl\xe9s",type:"text",value:"denglish"},{label:"Portugu\xe9s",type:"text",value:"dportuguese"},{label:"Codigo Venta",type:"text",value:"codigoventa"}],V=[{component:A,path:""}];let J=(()=>{class t{}return t.\u0275mod=d.Kb({type:t}),t.\u0275inj=d.Jb({factory:function(e){return new(e||t)},imports:[[l.a.forChild(V)],l.a]}),t})();var G=i("mFH5"),H=i("gcUQ"),U=i("R7+U"),Y=i("KZIX"),K=i("FlRo"),W=i("cePI"),Z=i("iAde"),z=i("k8N0"),X=i("PBFl"),_=i("bFHC"),$=i("Jb3d"),tt=i("66mq"),et=i("csyo");let it=(()=>{class t{}return t.\u0275mod=d.Kb({type:t}),t.\u0275inj=d.Jb({factory:function(e){return new(e||t)},imports:[[a.c,J,n.a,s.j,H.c,h.e,p.c,G.m,U.b,Y.a,K.m,s.s,W.c,Z.b,z.a,r.s,o.a,X.c,c.e,_.b,$.b,tt.b,et.b]]}),t})()}}]);