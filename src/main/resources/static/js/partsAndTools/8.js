(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{ivuJ:function(t,e,i){"use strict";i.r(e),i.d(e,"PartsToolsModule",(function(){return It}));var a=i("2kYt"),n=i("40Bj"),s=i("nIj0"),o=i("m1yc"),r=i("PCNd"),c=i("sEIs"),l=i("ruxD"),d=i("EM62"),m=i("OZ4H"),b=i("YtkY"),u=i("J0Eg"),h=i("W1gw");let p=(()=>{class t extends u.a{constructor(t,e){super(),this.pt=t,this._snackBar=e}loadData(t){return this.pt.getFilterAll({matriz:null==t?void 0:t.matriz,noRevision:null==t?void 0:t.noRevision,satatus:null==t?void 0:t.status,nivel:null==t?void 0:t.nivel,creationDate:null==t?void 0:t.creationDate,lastUpdateDate:null==t?void 0:t.lastUpdateDate,del:"N"}).pipe(Object(b.a)(t=>t.map(t=>({nombre:t.nombre,noRevision:t.noRevision,status:t.status.satus,id:t.idMatriz,nivel:t.ns.serviceLevel,creationDate:t.creationDate,lastUpdateDate:t.lastUpdateDate,all:t}),console.log("Data Table",t.all),this.dataSource.replaceAll(t))))}push(t){this.dataSource.push(t)}showSanckBar(t,e,i){this._snackBar.open(t,"OK",{duration:3e3,horizontalPosition:e||"center",verticalPosition:i||"bottom"})}}return t.\u0275fac=function(e){return new(e||t)(d.Wb(o.n),d.Wb(h.a))},t.\u0275prov=d.Ib({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var f=i("jIqt"),g=i("/VsW"),v=i("DGrs"),y=i("qFEQ"),S=i("29Wa"),R=i("Cd2c"),F=i("R7+U"),D=i("PBFl"),B=i("bFHC"),x=i("mFH5"),w=i("csyo"),C=i("ulve");function N(t,e){1&t&&d.Nb(0,"shared-progress-bar")}function j(t,e){if(1&t&&(d.Qb(0),d.Dc(1),d.Pb()),2&t){const t=d.ec();d.Bb(1),d.Fc(" ",t.dictionary.translate("mandatoryField")," ")}}function L(t,e){if(1&t&&(d.Qb(0),d.Dc(1),d.Pb()),2&t){const t=d.ec();d.Bb(1),d.Fc(" ",t.dictionary.translate("maxOf")+"200 "+t.dictionary.translate("characters")," ")}}function k(t,e){1&t&&(d.Qb(0),d.Dc(1," Emisi\xf3n duplicada "),d.Pb())}function I(t,e){if(1&t&&(d.Qb(0),d.Dc(1),d.Pb()),2&t){const t=d.ec();d.Bb(1),d.Fc(" ",t.dictionary.translate("mandatoryField")," ")}}function M(t,e){if(1&t&&(d.Qb(0),d.Dc(1),d.Pb()),2&t){const t=d.ec();d.Bb(1),d.Fc(" ",t.dictionary.translate("maxOf")+"10 "+t.dictionary.translate("characters")," ")}}function O(t,e){if(1&t&&(d.Sb(0,"mat-option",27),d.Dc(1),d.Rb()),2&t){const t=e.$implicit;d.jc("value",t.id),d.Bb(1),d.Fc(" ",t.serviceLevel," ")}}function P(t,e){if(1&t&&(d.Sb(0,"mat-option",27),d.Dc(1),d.Rb()),2&t){const t=e.$implicit;d.jc("value",t.idStatus),d.Bb(1),d.Fc(" ",t.status," ")}}function $(t,e){if(1&t&&(d.Sb(0,"mat-option",27),d.Dc(1),d.Rb()),2&t){const t=e.$implicit;d.jc("value",t.value),d.Bb(1),d.Fc(" ",t.label," ")}}function E(t,e){if(1&t&&(d.Sb(0,"mat-option",27),d.Dc(1),d.Rb()),2&t){const t=e.$implicit;d.jc("value",t.spCode),d.Bb(1),d.Fc(" ",t.providerName," ")}}function T(t,e){1&t&&d.Nb(0,"mat-spinner",28),2&t&&d.jc("diameter",20)}function A(t,e){if(1&t&&(d.Sb(0,"mat-option",27),d.Dc(1),d.Rb()),2&t){const t=e.$implicit;d.jc("value",t.idEspm),d.Bb(1),d.Fc(" ",t.name," ")}}function q(t,e){1&t&&d.Nb(0,"mat-spinner",28),2&t&&d.jc("diameter",20)}function V(t,e){if(1&t&&(d.Sb(0,"mat-option",27),d.Dc(1),d.Rb()),2&t){const t=e.$implicit;d.jc("value",t.value),d.Bb(1),d.Fc(" ",t.label," ")}}function z(t,e){if(1&t&&(d.Sb(0,"mat-option",27),d.Dc(1),d.Rb()),2&t){const t=e.$implicit;d.jc("value",t.value),d.Bb(1),d.Fc(" ",t.label," ")}}function Q(t,e){1&t&&d.Nb(0,"mat-spinner",28),2&t&&d.jc("diameter",20)}function U(t,e){1&t&&d.Nb(0,"mat-spinner",29),2&t&&d.jc("diameter",30)}function _(t,e){if(1&t){const t=d.Tb();d.Sb(0,"mat-option",47),d.ac("onSelectionChange",(function(){d.sc(t);const i=e.$implicit,a=d.ec().index;return d.ec().setDataByPart(i,a)})),d.Dc(1),d.Rb()}if(2&t){const t=e.$implicit;d.jc("value",t.np),d.Bb(1),d.Fc(" ",t.np," ")}}function W(t,e){1&t&&d.Nb(0,"mat-spinner",28),2&t&&d.jc("diameter",20)}function G(t,e){if(1&t){const t=d.Tb();d.Sb(0,"div",30),d.Sb(1,"div",31),d.Sb(2,"mat-form-field",32),d.Sb(3,"mat-label"),d.Dc(4),d.Rb(),d.Sb(5,"input",33),d.ac("focus",(function(){d.sc(t);const i=e.index;return d.ec().fileManageNameControl(i)})),d.Rb(),d.Sb(6,"mat-autocomplete",null,34),d.Bc(8,_,2,2,"mat-option",35),d.fc(9,"async"),d.Rb(),d.Bc(10,W,1,1,"mat-spinner",14),d.Rb(),d.Sb(11,"mat-form-field",36),d.Sb(12,"mat-label"),d.Dc(13),d.Rb(),d.Nb(14,"input",37),d.Rb(),d.Sb(15,"mat-form-field",38),d.Sb(16,"mat-label"),d.Dc(17),d.Rb(),d.Nb(18,"input",39),d.Rb(),d.Sb(19,"mat-form-field",36),d.Sb(20,"mat-label"),d.Dc(21),d.Rb(),d.Nb(22,"input",40),d.Rb(),d.Sb(23,"mat-form-field",36),d.Sb(24,"mat-label"),d.Dc(25),d.Rb(),d.Nb(26,"input",41),d.Rb(),d.Sb(27,"div",42),d.Sb(28,"mat-label",43),d.Dc(29),d.Rb(),d.Nb(30,"input",44),d.Rb(),d.Sb(31,"div",45),d.Sb(32,"button",46),d.ac("click",(function(){d.sc(t);const i=e.index;return d.ec().deleteItem(i)})),d.Sb(33,"mat-icon"),d.Dc(34,"delete"),d.Rb(),d.Rb(),d.Rb(),d.Rb(),d.Rb()}if(2&t){const t=e.index,i=d.qc(7),a=d.ec();d.Bb(1),d.jc("formGroupName",t),d.Bb(3),d.Ec(a.dictionary.translate("np")),d.Bb(1),d.jc("matAutocomplete",i),d.Bb(3),d.jc("ngForOf",d.gc(9,10,a.filteredOptions[t])),d.Bb(2),d.jc("ngIf",a.loadProd),d.Bb(3),d.Ec(a.dictionary.translate("npLast")),d.Bb(4),d.Ec(a.dictionary.translate("desc")),d.Bb(4),d.Ec(a.dictionary.translate("points")),d.Bb(4),d.Ec(a.dictionary.translate("cant")),d.Bb(4),d.Ec("No "+a.dictionary.translate("points"))}}let H=(()=>{class t{constructor(t,e,i,a,n,s,o,r,c,l,m){this.fb=t,this.fs=e,this.pts=i,this.sl=a,this.ss=n,this.rs=s,this.sps=o,this.ms=r,this.oems=c,this.mts=l,this.dialog=m,this.ummins=window.cummins,this.disabledEvent=new d.o,this.specification=[],this.statusList=[],this.nServiceList=[],this.regionList=[],this.distList=[],this.modelsList=[],this.loading=!1,this.loadProd=!1,this.loadDist=!1,this.loadModel=!1,this.editRegion=!1,this.oemList=[],this.channelList=[],this.npList=[],this.filteredOptions=[],this.dataNp=[],this.namesDistArray=[],this.namesModelArray=[],this.flagMassive=!1}ngOnInit(){this.loadProd=!0,this.isNew=!this.data,this.title=this.dictionary.translate(this.isNew?"addTool":"editTool"),this.message=this.dictionary.translate("msgCreateTool"),this.setupForm(),this.ss.bringTheActives().subscribe(t=>{this.statusList=[...t]}),this.sl.getActives().subscribe(t=>{this.nServiceList=[...t]}),this.rs.bringTheActivesOnes().subscribe(t=>{this.regionList=[...t]}),this.oems.bringTheActivesOems().subscribe(t=>{this.oemList=[...t]}),this.sps.bringTheActivesDrDrl().subscribe(t=>{this.channelList=[...t]}),this.pts.bringPartsToolsActives().subscribe(t=>{this.loadProd=!1,this.npList=[...t],this.items=this.orderForm.get("items"),this.ManageNameControl(this.items.length-1)})}ngOnDestroy(){this.filteredOptions.length=0}get name(){return this.mainForm.get("name")}get noRevision(){return this.mainForm.get("noRevision")}get nivelService(){return this.mainForm.get("nivelService")}get status(){return this.mainForm.get("status")}get region(){return this.mainForm.get("region")}get dist(){return this.mainForm.get("dist")}get model(){return this.mainForm.get("model")}get oem(){return this.mainForm.get("oem")}get channel(){return this.mainForm.get("channel")}getDataInfoParts(t){this.loading=!0,this.pts.getDataInfo(t).subscribe(t=>{this.loading=!1,this.mainForm.patchValue({name:t.matriz.nombre,noRevision:t.matriz.noRevision,nivelService:t.matriz.ns.id,status:t.matriz.status.idStatus,region:t.region.id,dist:this.findValuesSelected(t.atributos,1),model:this.findValuesSelected(t.atributos,2),oem:this.findValuesSelected(t.atributos,3),channel:this.findValuesSelected(t.atributos,4)}),this.bringTheDistbyRegion(t.region.id),this.setDataRows(t.detalles),this.namesDist=String(this.namesDistArray),this.namesModel=String(this.namesModelArray)})}bringTheDistbyRegion(t){this.loadDist=!0,this.loadModel=!0,this.ms.getDistByRegion(t).subscribe(t=>{this.loadDist=!1,this.distList=[...t],console.log("Dist ",this.distList)}),this.ms.bringThemActivesbyRegion(t).subscribe(t=>{this.loadModel=!1,this.modelsList=[...t],console.log("Model ",this.modelsList)})}setupForm(){this.mainForm=this.fb.group({name:[null,[s.u.required,s.u.maxLength(200)]],noRevision:[null,[s.u.required,s.u.maxLength(10)]],nivelService:[null,[s.u.required]],status:[null,[s.u.required]],region:[null],dist:[null,[s.u.required]],model:[null,[s.u.required]],oem:[null,[s.u.required]],channel:[null,[s.u.required]]}),this.orderForm=this.fb.group({np:["",[s.u.required]],npLast:[{value:"",disabled:!0}],desc:[{value:"",disabled:!0}],points:[null,[s.u.required,s.u.min(.01),s.u.max(100)]],min:[null,[s.u.required,s.u.min(0)]],check:[!1],items:this.fb.array([this.createItem()])}),this.isNew||(this.message=this.dictionary.translate("msgEditTool"),1===this.orderForm.get("items").length&&this.deleteItem(0),this.getDataInfoParts(this.data.all.idMatriz))}ManageNameControl(t){const e=this.orderForm.get("items");this.filteredOptions[t]=e.at(t).get("np").valueChanges.pipe(Object(f.a)(""),Object(b.a)(t=>"string"==typeof t?t:t.np),Object(b.a)(t=>t?this._filter(t):this.npList.slice()))}fileManageNameControl(t){if(this.flagMassive){const e=this.orderForm.get("items");this.filteredOptions[t]=e.at(t).get("np").valueChanges.pipe(Object(f.a)(""),Object(b.a)(t=>"string"==typeof t?t:t.np),Object(b.a)(t=>t?this._filter(t):this.npList.slice()))}}_filter(t){const e=t.toLowerCase();return this.npList.filter(t=>0===t.np.toLowerCase().indexOf(e))}findValuesSelected(t,e){let i=[];const a=t.filter(t=>t.tipoAtributo===e);switch(e){case 1:a.map(t=>{this.namesDistArray.push(t.nombre),i.push(t.idText)});break;case 2:a.map(t=>{this.namesModelArray.push(t.nombre),i.push(t.idNumber)});break;default:a.map(t=>{i.push(t.idNumber)})}return console.log("V "+e,i),i}editToRegion(){this.editRegion=!0,this.dist.enable(),this.model.enable()}disableFields(){this.fs.disableFields(this.mainForm)}enableFields(){this.fs.enableFields(this.mainForm)}createItem(){return this.fb.group({np:["",[s.u.required]],npLast:[{value:"",disabled:!0}],desc:[{value:"",disabled:!0}],points:[null,[s.u.required,s.u.min(.01),s.u.max(100)]],min:[null,[s.u.required,s.u.min(1)]],check:[!1]})}createItemWithData(t){return console.log("Item NP ",t),this.fb.group({np:[t.np,[s.u.required]],npLast:[t.partes.nPAnterior],desc:[t.partes.dSpanish],points:[t.ponderacion,[s.u.required,s.u.min(.01),s.u.max(100)]],min:[t.qty,[s.u.required,s.u.min(1)]],check:[!1]})}createItemWithXlsx(t,e){if(e)return this.fb.group({np:[t[0]],npLast:[e.nPAnterior],desc:[e.dSpanish],points:[t[1]],min:[t[2]],check:[!1]})}findValuesNP(t){const e=this.orderForm.get("items").controls.filter(e=>e.value.np==String(t[0]));return console.log("Filter",e),0===e.length?this.npList.find(e=>e.np==String(t[0]))||!1:"duplicated"}addItem(){this.items=this.orderForm.get("items"),this.items.push(this.createItem()),this.ManageNameControl(this.items.length-1)}deleteItem(t){this.orderForm.get("items").removeAt(t),this.filteredOptions.splice(t,1)}setDataByPart(t,e){const i=this.orderForm.get("items"),a=i.controls.filter(e=>e.value.np===t.np);console.log("Filter",a),0===a.length?i.at(e).patchValue({npLast:t.nPAnterior,desc:t.dSpanish}):(this.mts.showSanckBar(this.dictionary.translate("validNP")),i.at(e).reset())}setDataRows(t){t.map(t=>{this.items=this.orderForm.get("items"),this.items.push(this.createItemWithData(t)),this.ManageNameControl(this.items.length-1)})}onChargeForm(t){1===this.orderForm.get("items").length&&this.deleteItem(0);const e=[];t.map((t,i)=>{this.items=this.orderForm.get("items");const a=this.findValuesNP(t);console.log(`Filter Value ${i} - F: ${a}`),a&&"duplicated"!=a?(this.items.push(this.createItemWithXlsx(t,a)),console.log(`R ${i} - Item Np:${t[0]}, P:${t[1]} C:${t[2]}`),void 0===t[1]&&(e.push("","",""),e.push(`${this.dictionary.translate("row")}: ${Number(i+2)} - ${this.dictionary.translate("notValue")} ${this.dictionary.translate("points")}`)),void 0===t[2]&&(e.push("","",""),e.push(`${this.dictionary.translate("row")}: ${Number(i+2)} - ${this.dictionary.translate("notValue")} ${this.dictionary.translate("cant")} `))):void 0===t[0]?(console.log(`R ${i} - Item Np:${t[0]}, P:${t[1]} C:${t[2]}`),void 0===t[1]||void 0===t[2]?(e.push("","",""),e.push(`${this.dictionary.translate("row")}: ${Number(i+2)} - ${this.dictionary.translate("notValue")} NP, ${this.dictionary.translate("points")}, ${this.dictionary.translate("cant")} `)):(e.push("","",""),e.push(`${this.dictionary.translate("row")}: ${Number(i+2)} - ${this.dictionary.translate("notValue")} NP`))):"duplicated"===a?(e.push("","",""),e.push(`${this.dictionary.translate("row")}: ${Number(i+2)} - NP ${t[0]} ${this.dictionary.translate("duplicatedValues")}`)):(e.push("","",""),e.push(`${this.dictionary.translate("row")}: ${Number(i+2)} - NP ${t[0]} ${this.dictionary.translate("notExist")}`))}),console.log("Up...",e),e.length>0&&this.openResults(e),0===e.length&&e.push("Datos cargados: "+t.length),this.messageLoad=null}openResults(t){this.dialog.open(v.a,{disableClose:!1,height:"400px",width:"600px",data:{massiveLoadErrors:t}})}onFileChange(t){let e;this.flagMassive=!0;const i=t.target;if(1!==i.files.length)throw new Error("Cannot use multiple files");const a=new FileReader;this.messageLoad=this.dictionary.translate("loading")+"...",a.onload=t=>{const i=g.read(t.target.result,{type:"binary"}),a=i.Sheets[i.SheetNames[0]];console.log("ws",a),e=g.utils.sheet_to_json(a,{header:1});let n=e.filter((t,e)=>0!=e);console.log("Xlsx",n),this.onChargeForm(n)},a.readAsBinaryString(i.files[0])}autoEvaluation(){const t=this.sumPointsChecked();if(console.log("Sum ",t),t<100){let e=100-t;const i=this.orderForm.get("items"),a=i.controls.filter(t=>!1===t.value.check);let n,s;if(console.log("Array UnCheck",a),e%a.length>0){n=(e/a.length).toFixed(2),console.log("Value "+n);let t=0;i.controls.map(i=>{i.value.check||(t++,i.patchValue(t===a.length?{points:e.toFixed(2)}:{points:n}),e-=n)})}else n=e/a.length,s=n*a.length+t,i.controls.map(t=>{t.value.check||t.patchValue({points:n})});console.log("Total ",s)}else this.mts.showSanckBar(this.dictionary.translate("validSum")+" Total "+t)}sumPoints(){const t=this.orderForm.get("items");let e=0;return t.controls.map(t=>{null!=t.value.points&&(e=Number(e+parseFloat(t.value.points)))}),Number(e.toFixed(2))}sumPointsChecked(){const t=this.orderForm.get("items");let e=0;return t.controls.map(t=>{0!=t.value.check&&(e+=null===t.value.point?0:parseFloat(t.value.points))}),Number(e.toFixed(2))}checkPoints(){const t=this.sumPoints();return 100===t||(this.mts.showSanckBar(this.dictionary.translate("fvalidSum")+" "+t),!1)}getForm(){return this.orderForm.get("items")}changeToCreate(){this.isNew||(this.isNew=!0,this.title=this.dictionary.translate(this.isNew?"addTool":"editTool"))}createToDeatilsObject(t){let e=[],i=[],a=!1;if(t.controls.map(t=>{i.find(e=>e===t.value.np)?(this.mts.showSanckBar(this.dictionary.translate("validNP")),a=!0):i.push(t.value.np)}),!a)return t.controls.map(t=>{e.push({np:t.value.np,ponderacion:t.value.points,qty:t.value.min})}),e}submit(){var t;this.disableFields();const e=this.mainForm.value,i=this.orderForm.get("items"),a=this.createToDeatilsObject(i);if(console.log("Detalles ",a),a&&this.checkPoints()){const i={matriz:{idMatriz:this.isNew?"":null===(t=this.data)||void 0===t?void 0:t.id,nombre:e.name,noRevision:e.noRevision,idNs:e.nivelService,idStatus:e.status,del:"N"},detalles:a,atributos:{tipoMatriz:"2",distribuidor:String(e.dist),modProductos:String(e.model),oems:String(e.oem),canal:String(e.channel)}};return console.log("Data save ",i),this.isNew?this.pts.saveInfo(i):this.pts.putInfo(i)}throw this.checkPoints(),new Error}debug(){console.log("Dist Form ",this.mainForm.value.dist),console.log("Model Form ",this.mainForm.value.model)}}return t.\u0275fac=function(e){return new(e||t)(d.Mb(s.f),d.Mb(o.g),d.Mb(o.n),d.Mb(o.q),d.Mb(o.t),d.Mb(o.p),d.Mb(o.r),d.Mb(o.j),d.Mb(o.k),d.Mb(p),d.Mb(m.b))},t.\u0275cmp=d.Gb({type:t,selectors:[["pat-main-form"]],inputs:{data:"data",dictionary:"dictionary"},decls:85,vars:39,consts:[[4,"ngIf"],["autocomplete","off","fxLayout","column","fxFlex","","fxLayoutAlign","center center",1,"form-parts-matrix",3,"formGroup"],["fxFlex","","fxLayout","row","fxLayoutAlign","space-between center",2,"width","90% !important"],["fxFlex","70"],["formControlName","name","matInput","","required","",3,"placeholder","keyup"],["fxFlex","70","fxFlexOffset","3"],["formControlName","noRevision","matInput","","required","",3,"placeholder","keyup"],["formControlName","nivelService","required","",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["formControlName","status","required","",3,"selectionChange"],["fxFlex","50"],["formControlName","region","required","",3,"selectionChange"],["fxFlex","50","fxFlexOffset","2"],["formControlName","dist","multiple","","required",""],["strokeWidth","3",3,"diameter",4,"ngIf"],["formControlName","model","multiple","","required",""],["fxFlex","","fxLayout","row","fxLayoutAlign","center center",2,"width","90% !important"],["formControlName","oem","multiple","","required",""],["formControlName","channel","multiple","","required",""],["fxLayout","column","fxFlex","","fxLayoutAlign","center center",2,"width","100% !important",3,"formGroup"],["fxLayout","row","fxLayoutAlign","center center"],["type","file","accept",".xlsx","multiple","false",3,"disabled","change"],["fxLayout","row","fxLayoutAlign","center center",2,"padding-top","1rem"],["mat-mini-fab","","color","basic",2,"background-color","#007402","color","#ffffff","margin-left","1rem","margin-right","1rem",3,"click"],["mat-mini-fab","","color","accent",2,"background-color","#474847","color","#ffffff",3,"click"],["strokeWidth","5",3,"diameter",4,"ngIf"],["fxLayout","row","fxLayoutAlign","center center","formArrayName","items","style","width: 100% !important",4,"ngFor","ngForOf"],[3,"value"],["strokeWidth","3",3,"diameter"],["strokeWidth","5",3,"diameter"],["fxLayout","row","fxLayoutAlign","center center","formArrayName","items",2,"width","100% !important"],["fxLayout","row","fxLayoutAlign","center center",2,"width","100% !important",3,"formGroupName"],["fxFlex","10"],["type","text","matInput","","formControlName","np","required","",3,"matAutocomplete","focus"],["auto","matAutocomplete"],[3,"value","onSelectionChange",4,"ngFor","ngForOf"],["fxFlex","10","fxFlexOffset","2"],["matInput","","name","npLast","formControlName","npLast","readonly",""],["fxFlex","20","fxFlexOffset","2"],["matInput","","formControlName","desc","readonly",""],["matInput","","formControlName","points","type","number","required",""],["matInput","","formControlName","min","type","number","required",""],["fxFlex","8","fxFlexOffset","2",2,"text-align","center"],[2,"font-size",".6rem"],["type","checkbox","formControlName","check"],["fxFlex","5","fxFlexOffset","3"],["mat-mini-fab","","color","warn",3,"click"],[3,"value","onSelectionChange"]],template:function(t,e){1&t&&(d.Bc(0,N,1,0,"shared-progress-bar",0),d.Sb(1,"form",1),d.Sb(2,"h1"),d.Dc(3),d.Rb(),d.Sb(4,"div",2),d.Sb(5,"mat-form-field",3),d.Sb(6,"input",4),d.ac("keyup",(function(){return e.changeToCreate()})),d.Rb(),d.Sb(7,"mat-error"),d.Bc(8,j,2,1,"ng-container",0),d.Bc(9,L,2,1,"ng-container",0),d.Bc(10,k,2,0,"ng-container",0),d.Rb(),d.Rb(),d.Sb(11,"mat-form-field",5),d.Sb(12,"input",6),d.ac("keyup",(function(){return e.changeToCreate()})),d.Rb(),d.Sb(13,"mat-error"),d.Bc(14,I,2,1,"ng-container",0),d.Bc(15,M,2,1,"ng-container",0),d.Rb(),d.Rb(),d.Rb(),d.Sb(16,"div",2),d.Sb(17,"mat-form-field",3),d.Sb(18,"mat-label"),d.Dc(19),d.Rb(),d.Sb(20,"mat-select",7),d.ac("selectionChange",(function(){return e.changeToCreate()})),d.Bc(21,O,2,2,"mat-option",8),d.Rb(),d.Sb(22,"mat-error"),d.Dc(23),d.Rb(),d.Rb(),d.Sb(24,"mat-form-field",5),d.Sb(25,"mat-label"),d.Dc(26),d.Rb(),d.Sb(27,"mat-select",9),d.ac("selectionChange",(function(){return e.changeToCreate()})),d.Bc(28,P,2,2,"mat-option",8),d.Rb(),d.Sb(29,"mat-error"),d.Dc(30),d.Rb(),d.Rb(),d.Rb(),d.Sb(31,"div",2),d.Sb(32,"mat-form-field",10),d.Sb(33,"mat-label"),d.Dc(34),d.Rb(),d.Sb(35,"mat-select",11),d.ac("selectionChange",(function(t){return e.bringTheDistbyRegion(t.value)})),d.Bc(36,$,2,2,"mat-option",8),d.Rb(),d.Sb(37,"mat-error"),d.Dc(38),d.Rb(),d.Rb(),d.Sb(39,"mat-form-field",12),d.Sb(40,"mat-label"),d.Dc(41),d.Rb(),d.Sb(42,"mat-select",13),d.Bc(43,E,2,2,"mat-option",8),d.Rb(),d.Sb(44,"mat-error"),d.Dc(45),d.Rb(),d.Bc(46,T,1,1,"mat-spinner",14),d.Rb(),d.Sb(47,"mat-form-field",12),d.Sb(48,"mat-label"),d.Dc(49),d.Rb(),d.Sb(50,"mat-select",15),d.Bc(51,A,2,2,"mat-option",8),d.Rb(),d.Sb(52,"mat-error"),d.Dc(53),d.Rb(),d.Bc(54,q,1,1,"mat-spinner",14),d.Rb(),d.Rb(),d.Sb(55,"div",16),d.Sb(56,"mat-form-field",10),d.Sb(57,"mat-label"),d.Dc(58),d.Rb(),d.Sb(59,"mat-select",17),d.Bc(60,V,2,2,"mat-option",8),d.Rb(),d.Sb(61,"mat-error"),d.Dc(62),d.Rb(),d.Rb(),d.Sb(63,"mat-form-field",12),d.Sb(64,"mat-label"),d.Dc(65),d.Rb(),d.Sb(66,"mat-select",18),d.Bc(67,z,2,2,"mat-option",8),d.Rb(),d.Sb(68,"mat-error"),d.Dc(69),d.Rb(),d.Rb(),d.Rb(),d.Sb(70,"form",19),d.Sb(71,"div",20),d.Bc(72,Q,1,1,"mat-spinner",14),d.Sb(73,"input",21),d.ac("change",(function(t){return e.onFileChange(t)})),d.Rb(),d.Rb(),d.Sb(74,"div",22),d.Sb(75,"button",23),d.ac("click",(function(){return e.autoEvaluation()})),d.Sb(76,"mat-icon"),d.Dc(77,"assignment_turned_in"),d.Rb(),d.Rb(),d.Sb(78,"button",24),d.ac("click",(function(){return e.addItem()})),d.Sb(79,"mat-icon"),d.Dc(80,"add"),d.Rb(),d.Rb(),d.Rb(),d.Sb(81,"div",22),d.Bc(82,U,1,1,"mat-spinner",25),d.Dc(83),d.Rb(),d.Bc(84,G,35,12,"div",26),d.Rb(),d.Rb()),2&t&&(d.jc("ngIf",e.loading),d.Bb(1),d.jc("formGroup",e.mainForm),d.Bb(2),d.Ec(e.title),d.Bb(3),d.jc("placeholder",e.dictionary.translate("name")),d.Bb(2),d.jc("ngIf",e.name.invalid&&e.name.errors.required),d.Bb(1),d.jc("ngIf",e.name.invalid&&e.name.errors.maxlength),d.Bb(1),d.jc("ngIf",e.name.invalid&&e.name.errors.duplicated),d.Bb(2),d.jc("placeholder",e.dictionary.translate("noRevision")),d.Bb(2),d.jc("ngIf",e.noRevision.invalid&&e.noRevision.errors.required),d.Bb(1),d.jc("ngIf",e.noRevision.invalid&&e.noRevision.errors.maxlength),d.Bb(4),d.Ec(e.dictionary.translate("nivelService")),d.Bb(2),d.jc("ngForOf",e.nServiceList),d.Bb(2),d.Fc(" ",e.dictionary.translate("mandatoryField")," "),d.Bb(3),d.Ec(e.dictionary.translate("status")),d.Bb(2),d.jc("ngForOf",e.statusList),d.Bb(2),d.Fc(" ",e.dictionary.translate("mandatoryField")," "),d.Bb(4),d.Ec(e.dictionary.translate("region")),d.Bb(2),d.jc("ngForOf",e.regionList),d.Bb(2),d.Fc(" ",e.dictionary.translate("mandatoryField")," "),d.Bb(3),d.Ec(e.dictionary.translate("dist")),d.Bb(2),d.jc("ngForOf",e.distList),d.Bb(2),d.Fc(" ",e.dictionary.translate("mandatoryField")," "),d.Bb(1),d.jc("ngIf",e.loadDist),d.Bb(3),d.Ec(e.dictionary.translate("model")),d.Bb(2),d.jc("ngForOf",e.modelsList),d.Bb(2),d.Fc(" ",e.dictionary.translate("mandatoryField")," "),d.Bb(1),d.jc("ngIf",e.loadModel),d.Bb(4),d.Ec(e.dictionary.translate("oem")),d.Bb(2),d.jc("ngForOf",e.oemList),d.Bb(2),d.Fc(" ",e.dictionary.translate("mandatoryField")," "),d.Bb(3),d.Ec(e.dictionary.translate("channel")),d.Bb(2),d.jc("ngForOf",e.channelList),d.Bb(2),d.Fc(" ",e.dictionary.translate("mandatoryField")," "),d.Bb(1),d.jc("formGroup",e.orderForm),d.Bb(2),d.jc("ngIf",e.loadProd),d.Bb(1),d.jc("disabled",e.loadProd),d.Bb(9),d.jc("ngIf",e.messageLoad),d.Bb(1),d.Fc(" ",e.messageLoad," "),d.Bb(1),d.jc("ngForOf",e.orderForm.get("items").controls))},directives:[a.l,s.v,s.o,y.d,y.a,y.c,s.h,S.c,s.d,R.b,s.n,s.g,s.t,S.b,y.b,S.f,F.a,a.k,D.b,B.a,o.o,x.n,w.c,s.e,s.i,C.c,C.a,s.r,s.a],pipes:[a.b],styles:[".mat-dialog-content[_ngcontent-%COMP%]{display:block;margin:0 -24px;padding:0 24px;max-height:65vh;overflow:auto;width:450px}.form-parts-matrix[_ngcontent-%COMP%]{width:100%}.cdk-overlay-pane[_ngcontent-%COMP%]{width:800px!important}"]}),t})(),J=(()=>{class t{constructor(t,e,i){this.data=t,this.dialogRef=e,this.message=i,this.loading=!1}ngOnInit(){}onClose(){this.dialogRef.close()}onSubmit(){this.loading=!0,this.mfc.disableFields();try{this.mfc.submit().subscribe(t=>{this.loading=!1,this.mfc.enableFields(),console.log("Res ",t),this.message.show(this.data.dictionary.translate("saveData")),this.dialogRef.close()},t=>{this.loading=!1,this.mfc.enableFields(),this.message.show(t.message||"Error de conexi\xf3n")})}catch(t){this.loading=!1,console.log("Err ",t),this.mfc.enableFields()}}}return t.\u0275fac=function(e){return new(e||t)(d.Mb(m.a),d.Mb(m.f),d.Mb(o.i))},t.\u0275cmp=d.Gb({type:t,selectors:[["pat-main-form-dialog"]],viewQuery:function(t,e){var i;1&t&&d.Hc(H,!0),2&t&&d.pc(i=d.bc())&&(e.mfc=i.first)},decls:2,vars:7,consts:[[3,"disabled","loading","title","submitText","cancelText","closeEvent","submitEvent"],[3,"dictionary","data"]],template:function(t,e){1&t&&(d.Sb(0,"shared-form-dialog",0),d.ac("closeEvent",(function(){return e.onClose()}))("submitEvent",(function(){return e.onSubmit()})),d.Nb(1,"pat-main-form",1),d.Rb()),2&t&&(d.jc("disabled",e.loading||!(null!=e.mfc&&e.mfc.mainForm.valid)||(null==e.mfc?null:e.mfc.orderForm.get("items").invalid))("loading",e.loading)("title",e.title)("submitText",e.data.dictionary.translate("save"))("cancelText",e.data.dictionary.translate("cancel")),d.Bb(1),d.jc("dictionary",e.data.dictionary)("data",e.data.tool))},directives:[o.f,H],styles:[""]}),t})();var K=i("FlRo"),X=i("iAde"),Y=i("cePI"),Z=i("Jb3d");function tt(t,e){1&t&&d.Nb(0,"shared-progress-bar")}function et(t,e){if(1&t&&(d.Sb(0,"th",21),d.Dc(1),d.Rb()),2&t){const t=d.ec();d.Bb(1),d.Fc(" ",t.dictionary.translate("matriz")," ")}}function it(t,e){if(1&t&&(d.Sb(0,"td",22),d.Dc(1),d.Rb()),2&t){const t=e.$implicit;d.Bb(1),d.Fc(" ",t.nombre," ")}}function at(t,e){if(1&t&&(d.Sb(0,"th",21),d.Dc(1),d.Rb()),2&t){const t=d.ec();d.Bb(1),d.Fc(" ",t.dictionary.translate("noRevision")," ")}}function nt(t,e){if(1&t&&(d.Sb(0,"td",22),d.Dc(1),d.Rb()),2&t){const t=e.$implicit;d.Bb(1),d.Fc(" ",t.noRevision," ")}}function st(t,e){if(1&t&&(d.Sb(0,"th",21),d.Dc(1),d.Rb()),2&t){const t=d.ec();d.Bb(1),d.Fc(" ",t.dictionary.translate("status")," ")}}function ot(t,e){if(1&t&&(d.Sb(0,"td",22),d.Dc(1),d.Rb()),2&t){const t=e.$implicit;d.Bb(1),d.Fc(" ",t.status," ")}}function rt(t,e){if(1&t&&(d.Sb(0,"th",21),d.Dc(1),d.Rb()),2&t){const t=d.ec();d.Bb(1),d.Fc(" ",t.dictionary.translate("nivel")," ")}}function ct(t,e){if(1&t&&(d.Sb(0,"td",22),d.Dc(1),d.Rb()),2&t){const t=e.$implicit;d.Bb(1),d.Fc(" ",t.nivel," ")}}function lt(t,e){if(1&t&&(d.Sb(0,"th",21),d.Dc(1),d.Rb()),2&t){const t=d.ec();d.Bb(1),d.Fc(" ",t.dictionary.translate("DateCreate")," ")}}function dt(t,e){if(1&t&&(d.Sb(0,"td",22),d.Dc(1),d.Rb()),2&t){const t=e.$implicit;d.Bb(1),d.Fc(" ",t.creationDate," ")}}function mt(t,e){if(1&t&&(d.Sb(0,"th",21),d.Dc(1),d.Rb()),2&t){const t=d.ec();d.Bb(1),d.Fc(" ",t.dictionary.translate("DateUpdate")," ")}}function bt(t,e){if(1&t&&(d.Sb(0,"td",22),d.Dc(1),d.Rb()),2&t){const t=e.$implicit;d.Bb(1),d.Fc(" ",t.lastUpdateDate," ")}}function ut(t,e){if(1&t&&(d.Sb(0,"th",23),d.Dc(1),d.Rb()),2&t){const t=d.ec();d.Bb(1),d.Fc(" ",t.dictionary.translate("actions")," ")}}function ht(t,e){if(1&t){const t=d.Tb();d.Sb(0,"td",22),d.Sb(1,"button",24),d.Sb(2,"mat-icon"),d.Dc(3,"more_vert"),d.Rb(),d.Rb(),d.Sb(4,"mat-menu",null,25),d.Sb(6,"button",26),d.ac("click",(function(){d.sc(t);const i=e.$implicit;return d.ec().onEdit(i)})),d.Sb(7,"mat-icon"),d.Dc(8,"edit"),d.Rb(),d.Sb(9,"span"),d.Dc(10,"Editar"),d.Rb(),d.Rb(),d.Sb(11,"button",26),d.ac("click",(function(){d.sc(t);const i=e.$implicit;return d.ec().onDelete(i)})),d.Sb(12,"mat-icon"),d.Dc(13,"delete"),d.Rb(),d.Sb(14,"span"),d.Dc(15,"Borrar"),d.Rb(),d.Rb(),d.Rb(),d.Rb()}if(2&t){const t=d.qc(5),e=d.ec();d.Bb(1),d.jc("matMenuTriggerFor",t),d.Bb(5),d.jc("matTooltip",e.dictionary.translate("edit")),d.Bb(5),d.jc("matTooltip",e.dictionary.translate("deleted"))}}function pt(t,e){1&t&&d.Nb(0,"tr",27)}function ft(t,e){1&t&&d.Nb(0,"tr",28)}function gt(t,e){if(1&t&&(d.Sb(0,"tr",29),d.Sb(1,"td",30),d.Dc(2),d.Rb(),d.Rb()),2&t){const t=d.ec(),e=d.qc(5);d.Bb(2),d.Gc("",t.dictionary.translate("notDatafind"),'"',e.value,'"')}}const vt=function(){return[5,10,25,100]};let yt=(()=>{class t{constructor(t,e,i,a){this.mts=t,this.message=e,this.dialog=i,this.tps=a,this.displayedColumns=["name","revision","status","nivel","dateCreate","dateUpdate","options"],this.columns=St,this.loading=!1,this.operations=Rt,this.subscriptions=[],this.getDataTable()}ngOnInit(){}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}ngOnDestroy(){}getDataTable(){this.loading=!0,this.tps.getActivesData().subscribe(t=>{this.loading=!1,console.log("Data Table ",t),this.dataSource=new K.l(t),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort})}applyFilter(t){this.dataSource.filter=t.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}onOperation(t){switch(t.operation){case"edit":this.onEdit(t.item);break;case"delete":this.onDelete(t.item)}}onEdit(t){this.dialog.open(J,{disableClose:!0,width:"1400px",height:"900px",data:{dictionary:this.dictionary,tool:t}}).afterClosed().subscribe(t=>{this.getDataTable(),t&&(this.message.genericSaveMessage(),this.getDataTable())},t=>this.message.show(t.message||"Error de conexi\xf3n"))}onDelete(t){this.loading=!0,this.tps.delete(t.id).subscribe(()=>{this.message.show(this.dictionary.translate("dataDeleted")),this.loading=!1,this.getDataTable()},t=>{this.message.show(t.message||"Error de conexi\xf3n"),this.loading=!1})}eventListeners(){this.subscriptions.push(this.mts.dataEvent.subscribe(t=>this.operations.forEach(e=>e.disabled=0===t.length)))}onAdd(){this.dialog.open(J,{disableClose:!0,width:"1400px",height:"900px",data:{dictionary:this.dictionary,tool:null}}).afterClosed().subscribe(t=>{this.getDataTable(),t&&(this.message.genericSaveMessage(),this.getDataTable())},t=>this.message.show(t.message||"Error de conexi\xf3n"))}}return t.\u0275fac=function(e){return new(e||t)(d.Mb(p),d.Mb(o.i),d.Mb(m.b),d.Mb(o.n))},t.\u0275cmp=d.Gb({type:t,selectors:[["pat-main-table"]],viewQuery:function(t,e){var i;1&t&&(d.Hc(X.a,!0),d.Hc(Y.a,!0)),2&t&&(d.pc(i=d.bc())&&(e.paginator=i.first),d.pc(i=d.bc())&&(e.sort=i.first))},inputs:{dictionary:"dictionary"},decls:34,vars:8,consts:[[4,"ngIf"],["fxLayoutAlign","center center",1,"pmt-search",2,"width","100%"],["matInput","",3,"keyup"],["input",""],[1,"mat-elevation-z8"],["mat-table","","matSort","",2,"width","100%",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","revision"],["matColumnDef","status"],["matColumnDef","nivel"],["matColumnDef","dateCreate"],["matColumnDef","dateUpdate"],["matColumnDef","options"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],[3,"pageSizeOptions"],[3,"text","callback"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell",""],["mat-icon-button","","aria-label","Example icon-button with a menu",3,"matMenuTriggerFor"],["menu","matMenu"],["mat-menu-item","",3,"matTooltip","click"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(t,e){1&t&&(d.Bc(0,tt,1,0,"shared-progress-bar",0),d.Sb(1,"mat-form-field",1),d.Sb(2,"mat-label"),d.Dc(3),d.Rb(),d.Sb(4,"input",2,3),d.ac("keyup",(function(t){return e.applyFilter(t)})),d.Rb(),d.Rb(),d.Sb(6,"div",4),d.Sb(7,"table",5),d.Qb(8,6),d.Bc(9,et,2,1,"th",7),d.Bc(10,it,2,1,"td",8),d.Pb(),d.Qb(11,9),d.Bc(12,at,2,1,"th",7),d.Bc(13,nt,2,1,"td",8),d.Pb(),d.Qb(14,10),d.Bc(15,st,2,1,"th",7),d.Bc(16,ot,2,1,"td",8),d.Pb(),d.Qb(17,11),d.Bc(18,rt,2,1,"th",7),d.Bc(19,ct,2,1,"td",8),d.Pb(),d.Qb(20,12),d.Bc(21,lt,2,1,"th",7),d.Bc(22,dt,2,1,"td",8),d.Pb(),d.Qb(23,13),d.Bc(24,mt,2,1,"th",7),d.Bc(25,bt,2,1,"td",8),d.Pb(),d.Qb(26,14),d.Bc(27,ut,2,1,"th",15),d.Bc(28,ht,16,3,"td",8),d.Pb(),d.Bc(29,pt,1,0,"tr",16),d.Bc(30,ft,1,0,"tr",17),d.Bc(31,gt,3,2,"tr",18),d.Rb(),d.Nb(32,"mat-paginator",19),d.Rb(),d.Sb(33,"shared-add-button",20),d.ac("callback",(function(){return e.onAdd()})),d.Rb()),2&t&&(d.jc("ngIf",e.loading),d.Bb(3),d.Ec(e.dictionary.translate("search")),d.Bb(4),d.jc("dataSource",e.dataSource),d.Bb(22),d.jc("matHeaderRowDef",e.displayedColumns),d.Bb(1),d.jc("matRowDefColumns",e.displayedColumns),d.Bb(2),d.jc("pageSizeOptions",d.mc(7,vt)),d.Bb(1),d.jc("text",e.dictionary.translate("addTool")))},directives:[a.l,S.c,y.c,S.f,R.b,K.k,Y.a,K.c,K.e,K.b,K.g,K.j,K.h,X.a,o.a,o.o,K.d,Y.b,K.a,D.b,Z.c,B.a,Z.d,Z.a,K.f,K.i],styles:["table[_ngcontent-%COMP%]{width:100%!important}.pmt-search[_ngcontent-%COMP%]   .mat-form-field-wrapper[_ngcontent-%COMP%]{width:100%}"]}),t})();const St=[{key:"nombre",label:"Matriz"},{key:"noRevision",label:"noRevision"},{key:"status",label:"status"},{key:"nivel",label:"Nivel"},{key:"creationDate",label:"DateCreate"},{key:"lastUpdateDate",label:"DateUpdate"},{key:"operations",label:"actions",type:o.b.Operations,value:[{label:"edit",matIcon:"edit",operation:"edit"},{label:"delete",matIcon:"delete",operation:"delete"}]}],Rt=[{disabled:!1,faIcon:"faFileExcel",label:"Exportar Reporte",operation:"export"}];function Ft(t,e){1&t&&d.Nb(0,"shared-progress-bar")}function Dt(t,e){if(1&t&&(d.Sb(0,"div"),d.Nb(1,"pat-main-table",1),d.Rb()),2&t){const t=d.ec();d.Bb(1),d.jc("dictionary",t.dictionary)}}let Bt=(()=>{class t{constructor(t,e,i,a){this.dialog=t,this.message=e,this.mts=i,this.tls=a,this.dictionary=new o.h,this.fields=xt,this.loading=!1,this.flag=!1}ngOnInit(){this.tls.getLenguaje().subscribe(t=>{this.dictionary.setLanguage(t.language),this.flag=!0})}onSearch(t){return this.loading=!0,t?this.mts.loadData(t).pipe(Object(l.a)(()=>this.loading=!1)).subscribe(()=>{},t=>this.message.genericHttpError(t.message||"Error de conexi\xf3n")):this.mts.loadData().pipe(Object(l.a)(()=>this.loading=!1)).subscribe(),null}}return t.\u0275fac=function(e){return new(e||t)(d.Mb(m.b),d.Mb(o.i),d.Mb(p),d.Mb(o.v))},t.\u0275cmp=d.Gb({type:t,selectors:[["pat-main-view"]],decls:3,vars:2,consts:[[4,"ngIf"],[3,"dictionary"]],template:function(t,e){1&t&&(d.Bc(0,Ft,1,0,"shared-progress-bar",0),d.Nb(1,"br"),d.Bc(2,Dt,2,1,"div",0)),2&t&&(d.jc("ngIf",e.loading),d.Bb(2),d.jc("ngIf",e.flag))},directives:[a.l,o.o,yt],styles:[""]}),t})();const xt=[{label:"Matriz",type:"text",value:"matriz"},{label:"N Revisi\xf3n",type:"text",value:"noRevision"},{label:"Estatus",type:"text",value:"status"},{label:"Nivel",type:"text",value:"nivel"},{label:"Fecha Creaci\xf3n",type:"text",value:"creationDate"},{label:"Ult. Modificaci\xf3n",type:"text",value:"lastUpdateDate"}],wt=[{component:Bt,path:""}];let Ct=(()=>{class t{}return t.\u0275mod=d.Kb({type:t}),t.\u0275inj=d.Jb({factory:function(e){return new(e||t)},imports:[[c.a.forChild(wt)],c.a]}),t})();var Nt=i("gcUQ"),jt=i("KZIX"),Lt=i("k8N0"),kt=i("66mq");let It=(()=>{class t{}return t.\u0275mod=d.Kb({type:t}),t.\u0275inj=d.Jb({factory:function(e){return new(e||t)},imports:[[a.c,Ct,n.a,s.j,Nt.c,S.e,R.c,x.m,F.b,jt.a,K.m,s.s,Y.c,X.b,Lt.a,o.s,r.a,D.c,m.e,B.b,Z.b,kt.b,w.b,h.b,w.b,C.b]]}),t})()}}]);